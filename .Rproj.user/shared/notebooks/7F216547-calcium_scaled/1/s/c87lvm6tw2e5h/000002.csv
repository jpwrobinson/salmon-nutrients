"0","## plot species posterior predictions"
"0",""
"0","stir<-stir %>% filter(nutrient == 'Ca')"
"0",""
"0","## drop outliers"
"0","outlier.lims<-stir %>% group_by(nutrient) %>% summarise(out = 2*sd(value) + mean(value))"
"2","`summarise()` ungrouping output (override with `.groups` argument)
"
"0","stir$lim<-outlier.lims$out[match(stir$nutrient, outlier.lims$nutrient)]"
"0","stir<-stir %>% filter(value <= lim)"
"0",""
"0",""
"0","## sort mast by FG"
"0","mast$FG<-stir$FG.fine[match(mast$species, stir$species)]"
"0","mast$species <-factor(mast$species, levels = rev(unique(mast$species[order(mast$FG)])))"
"0",""
"0","cols<-data.frame(col=c('#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00','#a65628'),"
"0","    FG=c('Herbivore Scraper', 'Piscivore', 'Herbivore Browser','Herbivore Grazer', 'Invertivore & Piscivore', 'Invertivore'))"
"0","cols.named<-cols$col"
"0","names(cols.named)<-cols$FG"
"0",""
"0","ggplot(mast ) + "
"0","	geom_rect(data = base, aes(ymin = lower95, ymax = upper95, xmin = -Inf, xmax=Inf), fill='red', alpha=0.2) +"
"0","	geom_hline(data = base, aes(yintercept=mu), col='red') +"
"0","	geom_pointrange("
"0","		aes(y = mu, x = species, ymin = lower95, ymax = upper95)) +"
"0","	geom_point(aes(y = mu, x = species, col=FG), size=2) +"
"0","	geom_jitter(data = stir, aes(species, value), alpha=0.25, width=0.15, size=0.75) +"
"0","	labs(y = 'Mineral concentration (mg per 100g)', x ='') +"
"0","	scale_colour_manual(values = cols.named) +"
"0","	facet_wrap(~nutrient, nrow=1, scales='free_x') + "
"0","	coord_flip() + "
"0","	# guides(colour=FALSE) + "
"0","	theme(axis.text.y=element_text(size=10, colour='black'),"
"0","		legend.position = 'top',"
"0","		legend.title = element_blank(),"
"0","			axis.text.x=element_text(size=10, colour='black'),"
"0","				axis.line = element_line(colour = ""black""), "
"0","				strip.text = element_text(face=""bold"", colour='black', size=10))"
"0",""
