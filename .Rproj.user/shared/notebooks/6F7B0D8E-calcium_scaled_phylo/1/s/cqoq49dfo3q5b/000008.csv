"0",""
"0","## convert focal.fit to list"
"0","focal.list<-as.list(focal.fit)"
"0","focal.list$Dmat<-Dmat"
"0","focal.list$Dmat_sp<-Dmat_sp"
"0","focal.list$N_dat<-nrow(focal.fit)"
"0","focal.list$N_spp<-uniques(focal.fit$species)"
"0",""
"0","# fit model"
"0",""
"0","nt_m<-ulam("
"0","        alist("
"0","          logvalue ~ dnorm(mu, sigma),"
"0","          ## intercept is species level effects"
"0","          mu <-"
"0","              # continuous    "
"0","                B4_TL*TL +"
"0","                B5_PEL*pelagic +"
"0","                B6_LMX*Lmax +"
"0","                B8_K*K +"
"0","                B9_AM*tm + "
"0","                B13_RIV*river_iron +"
"0","                B14_SOIL*soil_quality +"
"0","            "
"0","              # hierarchical"
"0","                B_ID[paper_id]*sigma_id +"
"0","                B0_ORD[Order]*sigma_ord +"
"0","                B15_FAM[family]*sigma_fam +"
"0","                B1_HAB[Habitat] +"
"0","                B2_TR[EnvTemp] +"
"0","                B7_BOD[BodyShapeI] +"
"0","          			B10_FOS[form_clean] + "
"0","                B12_SEA[source]*sigma_source, 	"
"0","                X_sp[species], #phylogeny"
"0","          "
"0","          ## priors"
"0","          vector[N_spp]:X_sp ~ multi_normal(0, SIGMA),"
"0","          matrix[N_spp, N_spp]: SIGMA <- cov_GPL1(Dmat_sp , etasq, rhosq, 0.01),# random"
"0","          "
"0","          B_ID[paper_id] ~ dnorm(0, 1),"
"0","          B0_ORD[Order] ~ dnorm(0, 1),"
"0","          B1_HAB[Habitat] ~ dnorm(0, sigma_hab),"
"0","          B2_TR[EnvTemp] ~ dnorm(0, sigma_temp),"
"0","          B4_TL ~ dnorm(0, 1000),"
"0","          B5_PEL ~ dnorm(0, 1000),"
"0","    		  B6_LMX ~ dnorm(0, 1000),"
"0","    		  B7_BOD[BodyShapeI] ~ dnorm(0, sigma_bod),"
"0","    		  B8_K ~ dnorm(0, 1000),"
"0","    		  B9_AM ~ dnorm(0, 1000),"
"0","    		  B10_FOS[form_clean] ~ dnorm(0, sigma_form),"
"0","    		  B12_SEA[source]~ dnorm(0, 1),"
"0","    		  B13_RIV ~ dnorm(0, 1000),"
"0","    		  B14_SOIL ~ dnorm(0, 1000),"
"0","    		  B15_FAM[family] ~ dnorm(0, 1),"
"0","    		  "
"0","          c(sigma_id, sigma_ord, sigma_fam, sigma_hab, sigma_temp, sigma_bod, sigma_form, sigma_source, scale) ~ dexp(2)"
"0","        ),"
"0","        data=focal.list, iter=5000, warmup=1500, chains=3, cores = 4, control=list(adapt_delta=0.99), constraints=list(a=""lower=0""), log_lik = TRUE)"
"2","Removing one or more character or factor variables:
"
"2","species
"
"2","Error in get_dist_template(the_dist[1]) : 
  No template for distribution 'species'
"
